<!-- define ant target "roundtrip" for uni test -->
<project>
	<target name="_roundtrip">

		<!-- setup roundtrip input and output dir -->
		<property name="roundtrip-in-dir" value="${out.dir}/roundtrip-results" />
		<property name="roundtrip-out-dir" value="sample/po" />
		<delete dir="${roundtrip-out-dir}" />
		<mkdir dir="${roundtrip-out-dir}" />

		<!-- run 2 way test -->
		<uploadpo user="bob" apiKey="${bob.key}" dst="${docsUrl}" srcDir="${roundtrip-in-dir}" debug="true" />
		<downloadpo user="bob" apiKey="${bob.key}" src="${docsUrl}" dstDir="${roundtrip-out-dir}" debug="true" />

		<!-- diff if input and output are same -->
		<exec executable="diff" failonerror="true">
			<arg value="--unified" />
			<arg value="--recursive" />
			<arg value="${roundtrip-in-dir}" />
			<arg value="${roundtrip-out-dir}" />
		</exec>

	</target>
</project>
