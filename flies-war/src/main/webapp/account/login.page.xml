<?xml version="1.0" encoding="UTF-8"?>
<page xmlns="http://jboss.com/products/seam/pages" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://jboss.com/products/seam/pages http://jboss.com/products/seam/pages-2.1.xsd"
	action="#{identity.isLoggedIn}">
	<param name="continue" value="#{userRedirect.encodedUrl}" />
	<header name="Cache-Control" value="no-cache, no-store, max-age=0, must-revalidate"/>
	<navigation from-action="#{identity.login}">
		<rule if="#{identity.loggedIn and not userRedirect.redirect}">
			<end-conversation before-redirect="true" />
			<redirect view-id="/home.xhtml" />
		</rule>
		<rule if="#{identity.loggedIn and userRedirect.redirect}">
			<end-conversation before-redirect="true" />
			<redirect url="#{userRedirect.url}" />
		</rule>
	</navigation>

	<!-- The following will redirect if logged in users try to access this page. 
		TODO: There is probably a cleaner way of doing this. -->
	<navigation from-action="#{identity.isLoggedIn}">
		<rule if="#{identity.loggedIn and not userRedirect.redirect}">
			<end-conversation before-redirect="true" />
			<redirect view-id="/home.xhtml" />
		</rule>
		<rule if="#{identity.loggedIn and userRedirect.redirect}">
			<end-conversation before-redirect="true" />
			<redirect url="#{userRedirect.url}" />
		</rule>
	</navigation>

</page>
